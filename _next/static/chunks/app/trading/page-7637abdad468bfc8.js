(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[552],{4175:(e,a,t)=>{Promise.resolve().then(t.bind(t,771))},771:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>h});var s=t(5155),l=t(2115),n=t(9092),r=t(6911),c=t(3201),o=t(5631),i=t(8808),d=t(6141),u=t(2316),m=t(2276),w=t(4570),g=t(9659),x=t(5016);let h=()=>{let{walletConnected:e,walletAddress:a,connectWallet:t}=(0,n.v)(),[h,p]=(0,l.useState)(!1),[f,b]=(0,l.useState)("MockERC20"),[v,N]=(0,l.useState)("MOCK_USDC"),[j,y]=(0,l.useState)(""),[k,S]=(0,l.useState)(""),E="0xE314913f34Ddb810142Acca1Acd3C96603e42468",C="0x5BAAA2054Bba4A1FEAf52aFb8502B14c61A8Bed9",A="0x46caFcED9C1E16F05b474774144f325A16d9B26E",F=(e,a)=>{if(e===C)return{contract:new o.NZ(e,g.HV,a),decimals:6};if(e===A)return{contract:new o.NZ(e,w.HV,a),decimals:18};throw Error("Invalid token address.")},B=async e=>{if(!e||0>=parseFloat(e))return"0.00";try{let a=window.ethereum,t=new i.k(a),s=await t.getSigner(),l=new d.KA(m.HV),n=new o.NZ(E,l,s),r="MockERC20"===f?A:C,c="MockERC20"===v?A:C,{decimals:w}=F(r,s),g=u.XS(e,w),x=await n.getAmountsOut(g,r,c);console.log("Amount out: ",x);let{decimals:h}=F(c,s);return u.Js(x,h)}catch(e){return console.error("Error fetching swap preview:",e),"0.00"}},O=async(e,t)=>{let s=window.ethereum,l=new i.k(s),{contract:n,decimals:r}=F(e,await l.getSigner()),c=await n.balanceOf(a),o=u.XS(t,r);return console.log("Balance for ".concat(e,": ").concat(u.Js(c,r),", Required: ").concat(t)),c>=o},_=async(e,a,t)=>{console.log("begin to approve");let s=window.ethereum,l=new i.k(s),{contract:n}=F(a,await l.getSigner());try{let s=await n.allowance(e,t);if(console.log("".concat(a," 授权额度: ").concat(s.toString())),BigInt(s)===BigInt(0)){console.log("".concat(a," 授权不足，开始授权..."));let e=await n.approve(t,x.V);console.log("授权交易已提交，等待确认...",e.hash),await e.wait(),console.log("".concat(a," 授权成功"))}}catch(e){throw console.error("Error ensuring approval for ".concat(a,":"),e),Error("Failed to ensure approval for ".concat(a))}},M=async e=>{y(e),p(!0);let a=await B(e);console.log("Swap preview result:",a),S(a),p(!1)},R=async()=>{if(!(!j||0>=parseFloat(j)))try{p(!0);let e=window.ethereum,t=new i.k(e),s=await t.getSigner(),l=new d.KA(m.HV),n=new o.NZ(E,l,s),r="MockERC20"===f?A:C,w="MockERC20"===v?A:C;if(await _(a,r,E),!await O(r,j)){alert("Insufficient token balance. Please check your wallet."),p(!1);return}let{decimals:g}=F(r,s),x=u.XS(j,g),h=await n.swapExactTokensForTokens(x,0,r,w,a),b=await h.wait();console.log("Swap receipt:  ",b),alert("Swap successful!"),p(!1),y(""),S("");let N={walletAddress:a,fromToken:f,toToken:v,fromAmount:j,toAmount:k,timestamp:new Date().toISOString()},B=(0,c.J)("transactions")||[];(0,c.P)("transactions",[...B,N])}catch(e){console.error("Error during swap:",e),p(!1),alert("Swap failed. Please try again.")}};return(0,s.jsx)("div",{className:"min-h-screen bg-blue-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white shadow-lg rounded-lg p-6 w-full max-w-md",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"From"}),(0,s.jsxs)("div",{className:"flex items-center bg-purple-100 rounded-lg p-3 mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-indigo-500 rounded-full"}),(0,s.jsx)("span",{className:"text-gray-800 font-medium",children:f})]}),(0,s.jsx)("input",{type:"number",className:"ml-auto bg-transparent focus:outline-none text-right text-gray-800 w-20",placeholder:"0.00",value:j,onChange:e=>M(e.target.value),disabled:!e})]})]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(r.A,{onClick:()=>{b(v),N(f),y(""),S("")},className:"w-10 h-10 bg-blue-500 hover:bg-blue-600 rounded-full flex items-center justify-center",children:"↕️"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-gray-600 text-sm font-medium",children:"To (estimated)"}),(0,s.jsxs)("div",{className:"flex items-center bg-purple-100 rounded-lg p-3 mt-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-orange-500 rounded-full"}),(0,s.jsx)("span",{className:"text-gray-800 font-medium",children:v})]}),(0,s.jsx)("input",{type:"text",className:"ml-auto bg-transparent focus:outline-none text-right text-gray-800 w-20",placeholder:"0.00",value:k,readOnly:!0})]})]})]}),(0,s.jsx)("div",{className:"mt-6",children:e?(0,s.jsx)(r.A,{onClick:R,className:"w-full",disabled:h,children:h?"Loading...":"Swap"}):(0,s.jsx)(r.A,{onClick:t,className:"w-full",children:"Connect Wallet"})}),e&&(0,s.jsxs)("div",{className:"mt-4 text-sm text-gray-600",children:["Connected Wallet:"," ",(0,s.jsx)("span",{className:"font-medium",children:a})]})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[733,911,441,517,358],()=>a(4175)),_N_E=e.O()}]);